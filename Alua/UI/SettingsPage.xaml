<Page x:Class="Alua.UI.SettingsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <StackPanel HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Margin="20">
        <TextBox Header="Steam ID" PlaceholderText="Enter your SteamID here" MinWidth="250" Text="{x:Bind _settingsVM.SteamID, Mode=TwoWay}"/>

        <TextBox Header="RetroAchievements Username" PlaceholderText="Enter your RA username here" MinWidth="250"
                 Margin="0,20" Text="{x:Bind _settingsVM.RetroAchievementsUsername, Mode=TwoWay}"/>

        <TextBox Header="PSN Username" PlaceholderText="Enter your PSN SSO Token here" MinWidth="250"
                 Margin="0,20" Text="{x:Bind _settingsVM.PsnSSO, Mode=TwoWay}"/>

        <!-- Xbox Live Authentication -->
        <StackPanel Margin="0,20">
            <TextBlock Text="Xbox Live" FontWeight="Bold" Margin="0,0,0,5"/>
            <StackPanel Orientation="Horizontal" Spacing="10">
                <Button Content="Sign in with Microsoft" 
                        Click="{x:Bind AuthenticateXbox}" 
                        Visibility="{x:Bind IsXboxAuthenticated, Converter={StaticResource BoolNegationToVisibilityConverter}, Mode=OneWay}"
                        IsEnabled="{x:Bind IsAuthenticating, Converter={StaticResource BoolNegationConverter}, Mode=OneWay}"/>
                
                <StackPanel Orientation="Horizontal" Spacing="10" 
                            Visibility="{x:Bind IsXboxAuthenticated, Mode=OneWay}">
                    <TextBlock Text="Signed in as:" VerticalAlignment="Center"/>
                    <TextBlock Text="{x:Bind _settingsVM.XboxGamertag, Mode=OneWay}" 
                              FontWeight="Bold" VerticalAlignment="Center"/>
                    <Button Content="Sign Out" Click="{x:Bind SignOutXbox}" />
                </StackPanel>
                
                <ProgressRing IsActive="{x:Bind IsAuthenticating, Mode=OneWay}" />
            </StackPanel>
        </StackPanel>

        <Expander BorderBrush="transparent" Background="transparent">
            <Expander.Header>
                <StackPanel VerticalAlignment="Bottom" Orientation="Horizontal">
                    <TextBlock Text="{x:Bind _settingsVM.Version}" Margin="10"/>
                    <TextBlock Text="{x:Bind _settingsVM.BuildString}" Margin="10"/>
                </StackPanel>
            </Expander.Header>
            <Expander.Content>
                <StackPanel>
                    <TextBlock Text="Debug Settings" FontSize="24"/>
                    <Button Content="Show init page" Click="{x:Bind ShowInitialPage}"/>
                    <Button Content="Show logs" Click="{x:Bind ShowLogs}"/>
                </StackPanel>
            </Expander.Content>
        </Expander>

    </StackPanel>

</Page>
